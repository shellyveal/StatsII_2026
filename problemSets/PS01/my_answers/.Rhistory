return(p_val)
}
KS_pval(D1, data)
ks.test(data, "pnorm")
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*k-1)^2*pi^2)/(8*(D^2)))
KS_pval <- function(D, x) {
k <- seq_along(x)
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*k-1)^2*pi^2)/(8*(D^2)))
return(p_val)
}
KS_pval(D1, data)
KS_test(F_Fun = ecdf, x = data)
ecdf(data)
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
FVals <- as.numeric(F_Fun(x_sorted))
D_pos <- max(i/n - FVals)
D_neg <- max(FVals - (i-1)/n)
D <- max(D_pos, D_neg)
return(D)
}
KS_test(F_Fun = ecdf, x = data)
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
FVals <- F_Fun(x_sorted)
D_pos <- max(i/n - FVals)
D_neg <- max(FVals - (i-1)/n)
D <- max(D_pos, D_neg)
return(D)
}
KS_test(F_Fun = pnorm, x = data)
KS_test(FVals = empiricalCDF, x = data)
KS_test <- function(FVals, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
D_pos <- max(i/n - FVals)
D_neg <- max(FVals - (i-1)/n)
D <- max(D_pos, D_neg)
return(D)
}
KS_test(FVals = empiricalCDF, x = data)
KS_test(FVals = pnorm(data), x = data)
norm_data <- pnorm(10000)
KS_test(FVals = norm_data, x = data)
# 2) Using ks.test correctly (for comparison)
ks.test(data, "pnorm", 0, 1)   # or specify mean=mean(data), sd=sd(data) if you want fitted normal
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
FVals <- F_Fun(x_sorted)
D_pos <- max(i/n - FVals)
D_neg <- max(FVals - (i-1)/n)
D <- max(D_pos, D_neg)
return(D)
}
KS_test(F_Fun = pnorm, x = data)
KS_pval <- function(D, x) {
k <- seq_along(x)
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*k-1)^2*pi^2)/(8*(D^2)))
return(p_val)
}
KS_pval(D, data)
ks.test(data, "pnorm")
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
FVals <- F_Fun(x_sorted)
D <- max(abs(FVals - pnorm(data)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = pnorm, x = data)
KS_test(F_Fun = ecdf, x = data)
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
if (F_Fun == "ecdf") {
F_inter <- F_Fun(x_sorted)
FVals <-  F_inter(x_sorted)}
else {
F_Vals <- F_Fun(x_sorted)
}
D <- max(abs(FVals - pnorm(data)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = ecdf, x = data)
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
if (F_Fun == ecdf) {
F_inter <- F_Fun(x_sorted)
FVals <-  F_inter(x_sorted)}
else {
F_Vals <- F_Fun(x_sorted)
}
D <- max(abs(FVals - pnorm(data)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = ecdf, x = data)
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
if (identical(F_Fun, ecdf)) {
F_inter <- F_Fun(x_sorted)
FVals <-  F_inter(x_sorted)}
else {
F_Vals <- F_Fun(x_sorted)
}
D <- max(abs(FVals - pnorm(data)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = ecdf, x = data)
KS_test(F_Fun = pnorm, x = data)
KS_test(F_Fun = pnorm, x = data)
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
if (identical(F_Fun, ecdf)) {
F_inter <- F_Fun(x_sorted)
FVals <-  F_inter(x_sorted)}
else {
F_Vals <- F_Fun(x_sorted, ...)
}
D <- max(abs(FVals - pnorm(data)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = pnorm, x = data)
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
if (identical(F_Fun, ecdf)) {
F_inter <- F_Fun(x_sorted)
FVals <-  F_inter(x_sorted)}
else {
F_Vals <- F_Fun(x_sorted)
}
D <- max(abs(FVals - pnorm(data)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = pnorm, x = data)
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
if (identical(F_Fun, ecdf)) {
F_inter <- F_Fun(x_sorted)
FVals <-  F_inter(x_sorted)}
else {
FVals <- F_Fun(x_sorted)
}
D <- max(abs(FVals - pnorm(data)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = pnorm, x = data)
KS_test <- function(F_Fun, x) {
x_sorted <- sort(x)
n <- length(x_sorted)
i <- seq_along(x_sorted)
if (identical(F_Fun, ecdf)) {
F_inter <- F_Fun(x_sorted)
FVals <-  F_inter(x_sorted)}
else {
FVals <- F_Fun(x_sorted)
}
D <- max(abs(FVals - pnorm(x_sorted)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = pnorm, x = data)
KS_test(F_Fun = ecdf, x = data)
ks.test(data, "pnorm")
ggplot(df, aes(x = x, y =y)) +
geom_point()
ks.test(data, pnorm)
KS_test(F_Fun = ecdf, x = data)
KS_pval(D, data)
ks.test(data, "pnorm")
ks.test(data, "pnorm", alternative = "one-sided")
ks.test(data, "pnorm", alternative = "less")
ks.test(data, "pnorm", alternative = "greater")
ks.test(data, "pnorm")
KS_test <- function(F_Fun, x) {
if (identical(F_Fun, ecdf)) {
x <- sort(x)
n <- length(x)
i <- seq_along(x)
F_inter <- F_Fun(x)
FVals <-  F_inter(x)}
else {
n <- length(x)
i <- seq_along(x)
FVals <- F_Fun(x)
}
D <- max(abs(FVals - pnorm(x)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = ecdf, x = data)
KS_test(F_Fun = pnorm, x = data)
ks.test(data, "pnorm")
KS_test(F_Fun = ecdf, x = data)
ks.test(data, "pnorm")
KS_test(F_Fun = cauchy, x = data)
KS_test(F_Fun = pnorm, x = data)
KS_test(F_Fun = ppois, x = data)
KS_test(F_Fun = pt, x = data)
KS_test(F_Fun = pexp, x = data)
ks.test(data, "pexp")
KS_test(F_Fun = pnorm, x = data)
KS_test(F_Fun = ecdf, x = data)
ks.test(data, "pnorm")
ks.test(data, "ecdf")
ks.test(data, "pnorm")
KS_test(F_Fun = ecdf, x = data)
ks.test(data, "pnorm")
KS_test(F_Fun = ecdf, x = data)
ks.test(data, "pnorm")
set.seed (123)
data <- data.frame(x = runif(200, 1, 10))
data$y <- 0 + 2.75*data$x + rnorm(200, 0, 1.5)
squared_errors <- function(outcome, input, parameter) {
n      <- nrow(input)
k      <- ncol(input)
beta   <- parameter[1:k]
sigma2 <- parameter[k+1]^2
sq_e      <- (outcome - input%*%beta)^2
return(sq_e)
}
squared_errors <- function(outcome, input, parameter) {
n      <- nrow(input)
k      <- ncol(input)
beta   <- parameter[1:k]
sigma2 <- parameter[k+1]^2
sq_e      <- (outcome - input%*%beta)^2
return(sq_e)
}
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data),
par=c(1,1,1), hessian=T, method="BFGS")
squared_errors <- function(outcome, input, parameter) {
n      <- nrow(input)
k      <- ncol(input)
beta   <- parameter[1:k]
sigma2 <- parameter[k+1]^2
sq_e      <- (outcome - input%*%parameter)^2
return(sq_e)
}
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data),
par=c(1,1,1), hessian=T, method="BFGS")
squared_errors <- function(outcome, input, parameter) {
n      <- nrow(input)
k      <- ncol(input)
beta   <- parameter[1:k]
sigma2 <- parameter[k+1]^2
sq_e      <- (outcome - input%*%beta)^2
return(sq_e)
}
results_OLS()
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data),
par=c(1,1,1), hessian=T, method="BFGS")
data
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1,1), hessian=T, method="BFGS")
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=(data$x),
par=c(1,1,1), hessian=T, method="BFGS")
data$x
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=(data$x),
par=c(1,1), hessian=T, method="BFGS")
data$y
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=(data$x),
par=c(1,1), hessian=T, method="BFGS")
squared_errors <- function(outcome, input, parameter) {
input_mat <- as.matrix(input)
n      <- nrow(input_mat)
k      <- ncol(input_mat)
beta   <- parameter[1:k]
sigma2 <- parameter[k+1]^2
sum_sq_e      <- sum((outcome - input_mat%*%beta)^2)
return(sum_sq_e)
}
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1), hessian=T, method="BFGS")
results_OLS(data$y, data$x)
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1), hessian=T, method="BFGS")
results_OLS
squared_errors <- function(outcome, input, parameter) {
input_mat <- as.matrix(input)
n      <- nrow(input_mat)
k      <- ncol(input_mat)
beta   <- parameter[1:k]
sigma2 <- parameter[k+1]^2
sum_sq_e      <- sum((outcome - input_mat%*%beta)^2)
return(sum_sq_e, sigma2)
}
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1), hessian=T, method="BFGS")
results_OLS
squared_errors <- function(outcome, input, parameter) {
input_mat <- as.matrix(input)
n      <- nrow(input_mat)
k      <- ncol(input_mat)
beta   <- parameter[1:k]
sigma2 <- parameter[k+1]^2
sum_sq_e      <- sum((outcome - input_mat%*%beta)^2)
return(sum_sq_e)
}
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1), hessian=T, method="BFGS")
results_OLS
results_OLS$par
squared_errors <- function(outcome, input, parameter) {
input_mat <- as.matrix(input)
n      <- nrow(input_mat)
k      <- ncol(input_mat)
beta   <- parameter[1:k]
sum_sq_e      <- sum((outcome - input_mat%*%beta)^2)
return(sum_sq_e)
}
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1), hessian=T, method="BFGS")
results_OLS$par
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1,1), hessian=T, method="BFGS")
squared_errors <- function(outcome, input, parameter) {
input_mat <- as.matrix(input)
n      <- nrow(input_mat)
k      <- ncol(input_mat)
beta   <- parameter[1:k]
sigma2 <- parameter[k+1]^2
sum_sq_e      <- sum((outcome - input_mat%*%beta)^2)
return(sum_sq_e)
}
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1,1), hessian=T, method="BFGS")
results_OLS$par
results_OLS$par
squared_errors <- function(outcome, input, parameter) {
input_mat <- as.matrix(input)
n      <- nrow(input_mat)
k      <- ncol(input_mat)
beta   <- parameter[1:k]
sum_sq_e      <- sum((outcome - input_mat%*%beta)^2)
return(sum_sq_e)
}
results_OLS <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1), hessian=T, method="BFGS")
results_OLS$par
squared_errors_sigma <- function(outcome, input, parameter) {
input_mat <- as.matrix(input)
n      <- nrow(input_mat)
k      <- ncol(input_mat)
beta   <- parameter[1:k]
sigma2 <- parameter[k+1]^2
sum_sq_e      <- sum((outcome - input_mat%*%beta)^2)
return(sum_sq_e)
}
results_OLS_sigma <- optim(fn=squared_errors, outcome=data$y, input=cbind(1, data$x),
par=c(1,1,1), hessian=T, method="BFGS")
results_OLS_sigma$par
lm(data$y ~ data$x)
results_OLS$par
ggplot(df, aes(x = x, y =y)) + # Visualizing
geom_point()
KS_test <- function(F_Fun, x) {
if (identical(F_Fun, ecdf)) {
x <- sort(x)
n <- length(x)
i <- seq_along(x)
F_inter <- F_Fun(x)
FVals <-  F_inter(x)}
else {
n <- length(x)
i <- seq_along(x)
FVals <- F_Fun(x)
}
D <- max(abs(FVals - pnorm(x)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = ecdf, x = data)
set.seed(123)
# create empirical distribution of observed data
data_1 <- rcauchy(1000, location = 0, scale = 1)
ECDF <- ecdf(data_1)
empiricalCDF <- ECDF(data_1)
# generate test statistic
D <- max(abs(empiricalCDF - pnorm(data_1)))
df <- data.frame(
x = data_1,
y = empiricalCDF
)
ggplot(df, aes(x = x, y =y)) + # Visualizing
geom_point()
KS_test <- function(F_Fun, x) {
if (identical(F_Fun, ecdf)) {
x <- sort(x)
n <- length(x)
i <- seq_along(x)
F_inter <- F_Fun(x)
FVals <-  F_inter(x)}
else {
n <- length(x)
i <- seq_along(x)
FVals <- F_Fun(x)
}
D <- max(abs(FVals - pnorm(x)))
p_val <- (sqrt(2*pi)/D)*sum(exp(-(2*i-1)^2*pi^2)/(8*(D^2)))
return(list(
D = D,
p_value = p_val))
}
KS_test(F_Fun = ecdf, x = data_1)
ks.test(data, "pnorm")
ks.test(data_1, "pnorm")
set.seed (123)
set.seed (123)
data_2 <- data.frame(x = runif(200, 1, 10))
data_2$y <- 0 + 2.75*data_2$x + rnorm(200, 0, 1.5)
squared_errors <- function(outcome, input, parameter) {
input_mat <- as.matrix(input)
n <- nrow(input_mat)
k <- ncol(input_mat)
beta <- parameter[1:k]
sum_sq_e <- sum((outcome - input_mat%*%beta)^2)
return(sum_sq_e)
}
results_OLS <- optim(fn=squared_errors, outcome=data_2$y,
input=cbind(1, data_2$x), par=c(1,1),
hessian=T, method="BFGS")
results_OLS$par
lm(data_2$y ~ data_2$x)
pexp_y <- pexp(data_1)
KS_test(F_Fun = pexp, x = data_1)
df_pexp <- data.frame(
x = data_1,
y = pexp_y
)
ggplot(df_pexp, aes(x = x, y =y)) + # Visualizing
geom_point()
KS_test(F_Fun = pexp, x = data_1)
ks.test(data_1, pexp)
ggplot(df, aes(x = x, y =y)) + # Visualizing
geom_point() +
labs(title = "ECDF Data")
ggplot(df, aes(x = x, y =y)) + # Visualizing
geom_point() +
labs(title = "ECDF Data") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(df_pexp, aes(x = x, y =y)) + # Visualizing
geom_point() +
labs(title = "EXP Data") +
theme(plot.title = element_text(hjust = 0.5))
exp_plot <- ggplot(df_pexp, aes(x = x, y =y)) + # Visualizing
geom_point() +
labs(title = "EXP Data") +
theme(plot.title = element_text(hjust = 0.5))
ggsave("Exp.pdf", exp_plot, width = 8, height = 5, units = "in")
ggsave("ECDF.pdf", ECDF_plot, width = 8, height = 5, units = "in")
ECDF_plot <- ggplot(df, aes(x = x, y =y)) + # Visualizing
geom_point() +
labs(title = "ECDF Data") +
theme(plot.title = element_text(hjust = 0.5))
ggsave("ECDF.pdf", ECDF_plot, width = 8, height = 5, units = "in")
class(ecdf)
class(ecdf(data))
class(ecdf(data_1))
class(ecdf(ecdf(data_1)))
KS_test(F_Fun = ecdf, x = data_1)
ks.test(data_1, "pnorm")
KS_test(F_Fun = pexp, x = data_1)
ks.test(data_1, pexp)
results_OLS$par
lm(data_2$y ~ data_2$x)
rnorm(200, 0, 1.5)
